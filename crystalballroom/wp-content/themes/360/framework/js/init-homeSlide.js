$ = jQuery.noConflict();

jQuery(function(b){b(document).ready(function(){function k(a){"hide"==a?($nextImageBtn.fadeOut(),$prevImageBtn.fadeOut()):($nextImageBtn.fadeIn(),$prevImageBtn.fadeIn())}function g(a){a=a.children("img").attr("title");$img_title.data("imageTitle",a)}function h(a){var c=a.parents(".content").next().find("a").attr("href");null==c&&(c=b(".content").first().find("a").attr("href"));$outer_container.data("nextImage",c);a=a.parents(".content").prev().find("a").attr("href");null==a&&(a=b(".content").last().find("a").attr("href")); $outer_container.data("prevImage",a)}function i(a){$preloader.fadeIn("fast");var b=new Image;b.onload=l(b,m);b.src=a}function l(a,b){return function(){return b.apply(a,arguments)}}function m(){$bgimg.data("newImageW",this.width).data("newImageH",this.height);var a=$bgimg,b=this.width,f=this.height,d=this.src;a.fadeOut("fast",function(){a.attr("src","").attr("src",d);n(a,b,f);$preloader.fadeOut("fast",function(){a.fadeIn("slow")});var e=$img_title.data("imageTitle");e?(a.attr("alt",e).attr("title", e),$img_title.fadeOut("fast",function(){$img_title.html(e).fadeIn()})):$img_title.fadeOut("fast",function(){$img_title.html(a.attr("title")).fadeIn()})})}function n(a,c,f){var d=b(window).width(),e=b(window).height();if("original"!=$toolbar.data("imageViewMode")){var j=f/c,c=c/f;"full"==$toolbar.data("imageViewMode")?e/d<j?(b(a).attr("width",d),b(a).attr("height",j*d)):(b(a).attr("height",e),b(a).attr("width",c*e)):e/d>j?(b(a).attr("width",d),b(a).attr("height",j*d)):(b(a).attr("height",e),b(a).attr("width", c*e));b(a).css("margin-left",(d-b(a).width())/2);b(a).css("margin-top",(e-b(a).height())/2)}else b(a).attr("width",c),b(a).attr("height",f),b(a).css("margin-left",(d-c)/2),b(a).css("margin-top",(e-f)/2)}function p(a){var b=curtop=0;if(a.offsetParent){b=a.offsetLeft;for(curtop=a.offsetTop;a=a.offsetParent;)b+=a.offsetLeft,curtop+=a.offsetTop}return[curtop,b]}$defaultViewMode="full";$tsMargin=30;$scrollEasing=600;$scrollEasingType="easeOutCirc";$thumbnailsContainerOpacity=0.8;$thumbnailsContainerMouseOutOpacity= 0;$thumbnailsOpacity=0.6;$nextPrevBtnsInitState="show";$keyboardNavigation="on";$thumbnails_wrapper=b("#thumbnails_wrapper");$outer_container=b("#outer_container");$thumbScroller=b(".thumbScroller");$thumbScroller_container=b(".thumbScroller .container");$thumbScroller_content=b(".thumbScroller .content");$thumbScroller_thumb=b(".thumbScroller .thumb");$preloader=b("#preloader");$toolbar=b("#toolbar");$toolbar_a=b("#toolbar a");$bgimg=b("#bgimg");$img_title=b("#img_title");$nextImageBtn=b(".nextImageBtn"); $prevImageBtn=b(".prevImageBtn");b(window).load(function(){$toolbar.data("imageViewMode",$defaultViewMode);"full"==$defaultViewMode?$toolbar_a.html("<img src='toolbar_n_icon.png' width='50' height='50' />").attr("onClick","ImageViewMode('normal');return false").attr("title","Restore"):$toolbar_a.html("<img src='toolbar_fs_icon.png' width='50' height='50' />").attr("onClick","ImageViewMode('full');return false").attr("title","Maximize");k($nextPrevBtnsInitState);$thumbScroller_container.css("marginLeft", $tsMargin+"px");sliderLeft=$thumbScroller_container.position().left;sliderWidth=$outer_container.width();$thumbScroller.css("width",sliderWidth);var a=0;fadeSpeed=200;var c=document.getElementById("outer_container"),f=p(c);$thumbScroller_content.each(function(){var e=b(this);a+=e.innerWidth();$thumbScroller_container.css("width",a);e.children().children().children(".thumb").fadeTo(fadeSpeed,$thumbnailsOpacity)});$thumbScroller.mousemove(function(b){if($thumbScroller_container.width()>sliderWidth){var b= b.pageX-f[1],c=-((a+2*$tsMargin-sliderWidth-sliderWidth)*(b/sliderWidth)),d=b-c,g=c-b;b>c?$thumbScroller_container.stop().animate({left:-d},$scrollEasing,$scrollEasingType):b<c?$thumbScroller_container.stop().animate({left:g},$scrollEasing,$scrollEasingType):$thumbScroller_container.stop()}});$thumbnails_wrapper.fadeTo(fadeSpeed,$thumbnailsContainerOpacity);$thumbnails_wrapper.hover(function(){b(this).stop().fadeTo("slow",1)},function(){b(this).stop().fadeTo("slow",$thumbnailsContainerMouseOutOpacity)}); $thumbScroller_thumb.hover(function(){b(this).stop().fadeTo(fadeSpeed,1)},function(){b(this).stop().fadeTo(fadeSpeed,$thumbnailsOpacity)});b(window).resize(function(){n("#bgimg",$bgimg.data("newImageW"),$bgimg.data("newImageH"));$thumbScroller_container.stop().animate({left:sliderLeft},400,"easeOutCirc");var a=$outer_container.width();$thumbScroller.css("width",a);sliderWidth=a;f=p(c)});var d=new Image;d.onload=l(d,m);d.src=$bgimg.attr("src");$outer_container.data("nextImage",b(".content").first().next().find("a").attr("href")); $outer_container.data("prevImage",b(".content").last().find("a").attr("href"))});"none"!=$toolbar.css("display")&&$toolbar.fadeTo("fast",0.4);$toolbar.hover(function(){b(this).stop().fadeTo("fast",1)},function(){b(this).stop().fadeTo("fast",0.4)});b("#outer_container a").click(function(a){a.preventDefault();a=b(this);h(a);g(a);i(this);k("show")});$nextImageBtn.click(function(a){a.preventDefault();i($outer_container.data("nextImage"));a=b("#outer_container a[href='"+$outer_container.data("nextImage")+ "']");h(a);g(a)});$prevImageBtn.click(function(a){a.preventDefault();i($outer_container.data("prevImage"));a=b("#outer_container a[href='"+$outer_container.data("prevImage")+"']");h(a);g(a)});"on"==$keyboardNavigation&&b(document).keydown(function(a){if(39==a.keyCode)return i($outer_container.data("nextImage")),a=b("#outer_container a[href='"+$outer_container.data("nextImage")+"']"),h(a),g(a),!1;if(37==a.keyCode)return i($outer_container.data("prevImage")),a=b("#outer_container a[href='"+$outer_container.data("prevImage")+ "']"),h(a),g(a),!1})})});